<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="dark" />
  <title>En-Bus - Voyagez √† travers l'Afrique</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Exo+2:wght@300;400;600;700&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <link rel="stylesheet" href="https://npmcdn.com/flatpickr/dist/themes/dark.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#73d700" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="En-Bus" />
  <meta name="description"
    content="R√©servez vos billets de bus en ligne facilement et rapidement √† travers l'Afrique" />
  <meta name="keywords" content="bus, transport, afrique, r√©servation, billet, voyage" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-72.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-72.png" />
  <meta name="msapplication-TileColor" content="#73d700" />
  <meta name="msapplication-TileImage" content="/icons/icon-144.png" />

  <style>
    .seat-selected-anim {
      animation: pulse 0.6s cubic-bezier(0.4, 0, 0.6, 1) 1;
    }

    @keyframes pulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.15);
      }
    }

    /* Ajout des styles pour la PWA - vous pouvez les garder dans style.css aussi */
    .reservation-card-pwa {
      background-color: var(--color-surface);
      border: 1px solid var(--color-border);
      border-left: 4px solid var(--color-accent-glow);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-16);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      animation: fadeIn 0.5s ease-out;
    }

    .res-pwa-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: rgba(var(--color-background-rgb), 0.5);
      padding: var(--space-12) var(--space-16);
      font-weight: 600;
    }

    .res-pwa-booking-number {
      font-family: var(--font-mono, monospace);
      color: var(--color-text-secondary);
    }

    .res-pwa-status {
      font-weight: 700;
    }

    .res-pwa-body {
      padding: var(--space-16);
    }

    .res-pwa-body h4 {
      font-family: var(--font-logo, sans-serif);
      font-size: 1.25rem;
      margin-bottom: var(--space-8);
      color: var(--color-text-primary);
    }

    .res-pwa-body p {
      color: var(--color-text-secondary);
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .res-pwa-actions {
      padding: var(--space-16);
      background-color: rgba(var(--color-background-rgb), 0.7);
      border-top: 1px solid var(--color-border);
      display: flex;
      gap: var(--space-12);
    }

    .res-pwa-actions .btn {
      width: auto;
      flex-grow: 1;
    }

    .loading-spinner {
      text-align: center;
      padding: 48px;
      font-size: 1.2rem;
      color: var(--color-text-secondary);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* DANS index.html, dans la balise <style> */

    .btn-delete-local {
      background: none;
      border: none;
      color: var(--color-text-secondary);
      font-size: 1.2rem;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 50%;
      transition: all 0.2s;
      margin-left: auto;
      /* Pousse le bouton vers la droite */
      margin-right: 10px;
    }

    .btn-delete-local:hover {
      background-color: rgba(244, 67, 54, 0.2);
      color: #f44336;
    }




    /* DANS index.html, dans <style> */

    .trip-occupancy-info {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 16px;
      background-color: rgba(var(--color-accent-glow-rgb), 0.1);
      border: 1px solid var(--color-border);
      padding: 12px 20px;
      border-radius: var(--radius-lg);
      margin: 0 auto 24px;
      max-width: 500px;
      font-size: 14px;
      font-weight: 600;
      color: var(--color-text-secondary);
    }

    .trip-occupancy-info span strong {
      color: var(--color-accent-glow);
      font-size: 16px;
    }

    .trip-occupancy-info .danger {
      color: #ffa726;
      /* Orange pour attirer l'attention */
    }



    /* DANS index.html, dans <style> */

    .urgency-box {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1px;
      background-color: var(--color-border);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      overflow: hidden;
      margin-bottom: 24px;
    }

    .urgency-item {
      background-color: var(--color-surface);
      padding: 16px;
      text-align: center;
    }

    .urgency-label {
      display: block;
      font-size: 12px;
      color: var(--color-text-secondary);
      margin-bottom: 8px;
      text-transform: uppercase;
    }

    .urgency-value {
      display: block;
      font-size: 24px;
      font-weight: 700;
      font-family: var(--font-mono, monospace);
      color: var(--color-text-primary);
    }

    .urgency-value.danger {
      color: #f44336;
      animation: pulse-danger 1.5s infinite;
    }

    @keyframes pulse-danger {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.1);
      }
    }
  </style>
</head>

<body>
  <nav class="navbar">
    <!-- ... (votre navbar est correcte et reste inchang√©e) ... -->
    <div class="container">
      <div class="nav-content">
        <div class="nav-links desktop-links">
          <a href="#" onclick="showPage('home')">Accueil</a><a href="#" onclick="showPage('reservations')">Mes
            R√©servations</a>
        </div>
        <div class="logo" onclick="showPage('home')">
          <svg class="logo-svg animated-logo" width="44" height="44" viewBox="0 0 120 120"
            xmlns="http://www.w3.org/2000/svg" aria-label="Logo En-Bus">
            <defs>
              <radialGradient id="sunGrad" cx="50%" cy="50%" r="50%">
                <stop offset="0%" stop-color="#FFD86B" />
                <stop offset="55%" stop-color="#FF9B39" />
                <stop offset="100%" stop-color="#FF4B2B" />
              </radialGradient>
              <linearGradient id="winGrad" x1="0" x2="1" y1="0" y2="0">
                <stop offset="0%" stop-color="#CDE8FF" />
                <stop offset="100%" stop-color="#A9D2FF" />
              </linearGradient>
              <filter id="softGlow" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur stdDeviation="2" result="blur" />
                <feMerge>
                  <feMergeNode in="blur" />
                  <feMergeNode in="SourceGraphic" />
                </feMerge>
              </filter>
            </defs>
            <circle cx="60" cy="60" r="54" fill="url(#sunGrad)" class="sun-pulse" />
            <rect x="0" y="80" width="120" height="10" fill="#0B0F17" opacity="0.9" />
            <rect x="0" y="90" width="120" height="10" fill="#0B0F17" opacity="0.95" />
            <g class="road-lines" stroke="#F0F5F9" stroke-width="2" opacity="0.6" filter="url(#softGlow)">
              <line x1="12" y1="70" x2="36" y2="70" class="line-1" />
              <line x1="10" y1="74" x2="34" y2="74" class="line-2" />
              <line x1="8" y1="78" x2="32" y2="78" class="line-3" />
            </g>
            <g class="bus-moving" transform="translate(20,52)">
              <rect x="0" y="6" width="80" height="26" rx="5" fill="#F0F5F9" stroke="#0A0F15" stroke-width="2" />
              <path d="M64 6 L78 6 L80 22 L64 22 Z" fill="url(#winGrad)" stroke="#0A0F15" stroke-width="2" />
              <rect x="6" y="10" width="12" height="10" rx="2" fill="url(#winGrad)" stroke="#0A0F15"
                stroke-width="1.5" />
              <rect x="20" y="10" width="12" height="10" rx="2" fill="url(#winGrad)" stroke="#0A0F15"
                stroke-width="1.5" />
              <rect x="34" y="10" width="12" height="10" rx="2" fill="url(#winGrad)" stroke="#0A0F15"
                stroke-width="1.5" />
              <rect x="48" y="10" width="12" height="10" rx="2" fill="url(#winGrad)" stroke="#0A0F15"
                stroke-width="1.5" />
              <rect x="8" y="18" width="10" height="14" rx="1.5" fill="#E7EDF3" stroke="#0A0F15" stroke-width="1.5" />
              <circle cx="78" cy="24" r="2.8" fill="#FFEAA7" stroke="#0A0F15" stroke-width="1" class="headlight" />
              <rect x="0" y="28" width="80" height="4" fill="#E1E7EE" stroke="#0A0F15" stroke-width="1" />
              <g class="wheels">
                <circle cx="18" cy="36" r="6.8" fill="#0A0F15" class="wheel-outer" />
                <circle cx="18" cy="36" r="3.2" fill="#9AA5B1" class="wheel-inner" />
                <circle cx="62" cy="36" r="6.8" fill="#0A0F15" class="wheel-outer" />
                <circle cx="62" cy="36" r="3.2" fill="#9AA5B1" class="wheel-inner" />
              </g>
            </g>
          </svg>
          <span class="logo-text">En-Bus</span>
        </div>
        <div class="nav-links desktop-links">
          <a href="#" onclick="showPage('about')">√Ä propos</a><a href="#" onclick="showPage('contact')">Contact</a>
        </div>
        <button id="hamburger-btn" class="hamburger" aria-label="Ouvrir le menu" aria-expanded="false">
          <span></span><span></span><span></span>
        </button>
      </div>
      <div id="mobile-nav-menu" class="mobile-nav">
        <a href="#" onclick="showPage('home')" data-i18n="nav_home">Accueil</a>
        <a href="#" onclick="showPage('reservations')" data-i18n="nav_my_bookings">Mes R√©servations</a>

        <a href="#" onclick="showPage('about')" data-i18n="nav_about">√Ä propos</a>
        <a href="#" onclick="showPage('contact')" data-i18n="nav_contact">Contact</a>
      </div>

      <!-- ‚úÖ AJOUTER CE S√âLECTEUR DE LANGUE ICI -->
      <div class="language-selector">
        <button class="lang-btn" onclick="changeLanguage('fr')">üá´üá∑</button>
        <button class="lang-btn" onclick="changeLanguage('en')">üá¨üáß</butto>
      </div>
    </div>
  </nav>

  <main>
    <!-- Toutes les pages de l'application -->
    <div id="home-page" class="page active">
      <!-- ... (Contenu de la page d'accueil, inchang√©) ... -->
      <section class="hero">
        <div class="container">
          <div class="hero-content">

            <!-- ‚úÖ Cl√©s de traduction ajout√©es -->
            <h1 data-i18n="hero_title">Voyagez √† travers l'Afrique</h1>
            <p data-i18n="hero_subtitle">
              R√©servez vos billets de bus en ligne facilement et rapidement
            </p>
            <div class="search-box">
              <div class="search-form">
                <div class="form-row">
                  <div class="form-group">
                    <label for="origin" data-i18n="search_form_origin">Ville de d√©part</label>
                    <select id="origin" class="form-control"></select>
                  </div>
                  <div class="form-group">
                    <label for="destination" data-i18n="search_form_destination">Ville d'arriv√©e</label>
                    <select id="destination" class="form-control"></select>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label data-i18n="search_form_trip_type">Type de voyage</label>
                    <div class="trip-type-toggle" data-mode="one-way">
                      <label class="toggle-option active" data-value="one-way" data-i18n="search_form_one_way">Aller
                        simple</label>
                      <label class="toggle-option" data-value="round-trip"
                        data-i18n="search_form_round_trip">Aller-retour</label>
                      <div class="toggle-switch"></div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="travel-date" data-i18n="search_form_dates">Dates du voyage</label>
                    <input type="text" id="travel-date" class="form-control" data-i18n="search_form_dates_placeholder" placeholder="S√©lectionnez vos dates" />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label data-i18n="search_form_passengers">Passagers</label>
                    <div id="passenger-input" class="form-control passenger-selector">
                      <span id="passenger-summary">1 Adulte</span>
                    </div>
                    <div id="passenger-dropdown" class="passenger-dropdown-menu">
                      <div class="passenger-row">
                        <label data-i18n="search_form_adults">Adultes</label>
                        <div class="passenger-counter">
                          <button type="button" class="counter-btn" data-type="adults" data-action="decrement">
                            -
                          </button>
                          <span id="adults-count">1</span>
                          <button type="button" class="counter-btn" data-type="adults" data-action="increment">
                            +
                          </button>
                        </div>
                      </div>
                      <div class="passenger-row">
                        <label data-i18n="search_form_children">Enfants <small>(0-6 ans)</small></label>
                        <div class="passenger-counter">
                          <button type="button" class="counter-btn" data-type="children" data-action="decrement">
                            -
                          </button>
                          <span id="children-count">0</span>
                          <button type="button" class="counter-btn" data-type="children" data-action="increment">
                            +
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <button class="btn btn-primary btn-large" onclick="searchBuses()" data-i18n="search_form_button">
                  Rechercher
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section class="popular-destinations">
        <div class="container">
          <h2 data-i18n="popular_destinations_title">Destinations populaires</h2>
          <div class="destinations-grid" id="popular-destinations-grid"></div>
        </div>
      </section>
      <section class="why-en-bus">
        <div class="container">
          <h2 data-i18n="why_en_bus_title">Pourquoi choisir En-Bus ?</h2>
          <div class="features-grid">
            <div class="feature-card">
              <div class="feature-icon">üì±</div>
              <h3 data-i18n="feature_easy_booking">R√©servation facile</h3>
              <p data-i18n="feature_easy_booking_desc">R√©servez vos billets en quelques clics</p>

            </div>
            <div class="feature-card">
              <div class="feature-icon">üí∞</div>
              <h3 data-i18n="feature_best_prices">Meilleurs prix</h3>
              <p data-i18n="feature_best_prices_desc">Trouvez les meilleures offres</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">üöå</div>
              <h3 data-i18n="feature_comfort">Confort garanti</h3>
              <p data-i18n="feature_comfort_desc">Voyagez avec les meilleures compagnies</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">üîí</div>
              <h3 data-i18n="feature_security">S√©curit√© maximale</h3>
              <p data-i18n="feature_security_desc">Vos informations sont s√©curis√©es</p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div id="results-page" class="page">
      <!-- ... (Contenu de la page des r√©sultats, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <button class="btn btn-secondary" onclick="showPage('home')" data-i18n="results_back_button">
            ‚Üê Retour
          </button>
          <h2 data-i18n="results_title">R√©sultats de recherche</h2>
        </div>
        <div id="search-summary" class="search-summary"></div>
        <div class="filters-bar-enhanced">

          <!-- ... (filtre "Trier par" et "Compagnie" restent inchang√©s) ... -->

          <!-- ‚úÖ NOUVEAU FILTRE PAR LIEU DE D√âPART -->
          <div id="departure-location-filter-section" class="filter-section" style="display: none;">
            <label for="filter-departure-location" class="filter-label" data-i18n="filter_departure_location">
              <span class="filter-icon">üìç</span>
              Lieu de d√©part :
            </label>
            <select id="filter-departure-location" class="filter-select"
              onchange="updateFilter('departureLocation', this.value)">
              <!-- Les options seront g√©n√©r√©es dynamiquement par JavaScript -->
            </select>
          </div>

          <div class="filter-section">
            <label for="sort-by" class="filter-label" data-i18n="filter_sort_by">
              <span class="filter-icon">üîΩ</span> Trier par :
            </label>
            <select id="sort-by" class="filter-select" onchange="updateFilter('sortBy', this.value)">
              <option value="departure" data-i18n="sort_by_departure">Heure de d√©part</option>
              <option value="price" data-i18n="sort_by_price">Prix croissant</option>
              <option value="duration" data-i18n="sort_by_duration">Dur√©e du trajet</option>
              <option value="company" data-i18n="sort_by_company">Compagnie (A-Z)</option>
            </select>

          </div>
          <div class="filter-section">
            <label for="filter-company" class="filter-label" data-i18n="filter_company"></label>
            <span class="filter-icon">üöå</span> Compagnie :
            </label>
            <select id="filter-company" class="filter-select" onchange="updateFilter('company', this.value)">
              <option value="all" data-i18n="filter_all">Toutes</option>

              <option value="Oc√©an du Nord">Oc√©an du Nord</option>
              <option value="Trans Bony">Trans Bony</option>
              <option value="Stellimac">Stellimac</option>
              <option value="United Express">United Express</option>
              <option value="Touristique Express">Touristique Express</option>
              <option value="Garantie Express">Garantie Express</option>
              <option value="ABC Transport">ABC Transport</option>
              <option value="STC">STC</option>
            </select>
          </div>
          <div class="filter-section">
            <label for="filter-trip-type" class="filter-label" data-i18n="filter_trip_type">
              <span class="filter-icon">üõ£Ô∏è</span> Type :
            </label>
            <select id="filter-trip-type" class="filter-select" onchange="updateFilter('tripType', this.value)">
              <option value="all" data-i18n="filter_all">Tous</option>
              <option value="direct" data-i18n="filter_type_direct">Direct uniquement</option>
              <option value="stops" data-i18n="filter_type_stops">Avec arr√™ts</option>
              <option value="connections" data-i18n="filter_type_connections">Avec correspondances</option>
            </select>
          </div>
          <div class="filter-section">
            <label for="filter-time" class="filter-label" data-i18n="filter_departure_time">
              <span class="filter-icon">üïê</span> D√©part :
            </label>
            <select id="filter-time" class="filter-select" onchange="updateFilter('departureTime', this.value)">
              <option value="all" data-i18n="filter_time_all">Toute la journ√©e</option>
              <option value="morning" data-i18n="filter_time_morning">Matin (5h-12h)</option>
              <option value="afternoon" data-i18n="filter_time_afternoon">Apr√®s-midi (12h-17h)</option>
              <option value="evening" data-i18n="filter_time_evening">Soir√©e (17h-21h)</option>
              <option value="night" data-i18n="filter_time_night">Nuit (21h-5h)</option>
            </select>
          </div>
          <div class="filter-section filter-price">
            <label class="filter-label" data-i18n="filter_price">
              <span class="filter-icon">üí∞</span> Prix :
            </label>
            <div class="price-range-container">
              <div class="price-inputs">
                <div class="price-input-group">
                  <label for="price-min" class="price-label" data-i18n="filter_price_min">Min</label>
                  <input type="range" id="price-min" min="0" max="100000" step="1000" value="0"
                    oninput="updateFilter('priceMin', this.value)" />
                  <span id="price-min-display" class="price-display">0</span>
                  FCFA
                </div>
                <div class="price-input-group">
                  <label for="price-max" class="price-label" data-i18n="filter_price_max">Max</label>
                  <input type="range" id="price-max" min="0" max="100000" step="1000" value="100000"
                    oninput="updateFilter('priceMax', this.value)" />
                  <span id="price-max-display" class="price-display">100 000</span>
                  FCFA
                </div>
              </div>
            </div>
          </div>
          <div class="filter-section filter-amenities">
            <label class="filter-label" data-i18n="filter_amenities">
              <span class="filter-icon">‚öôÔ∏è</span> √âquipements :
            </label>
            <div class="amenities-checkboxes" id="amenities-filter-container"></div>
          </div>
          <div class="filter-section">
            <button class="btn btn-secondary btn-reset-filters" onclick="resetFilters()"
              data-i18n="filter_reset_button">
              üîÑ R√©initialiser
            </button>
          </div>
        </div>
        <div id="amenities-legend" class="amenities-legend"></div>
        <div id="results-list" class="results-list"></div>
      </div>
    </div>

    <div id="seats-page" class="page">
      <!-- ... (Contenu de la page des si√®ges, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <button class="btn btn-secondary" onclick="showPage('results')" data-i18n="seats_back_button">
            ‚Üê Retour
          </button>
          <h2 data-i18n="seats_title">S√©lection des si√®ges</h2>
        </div>
        <div
          class="max-w-4xl mx-auto bg-gray-800/50 backdrop-blur-sm p-4 sm:p-6 rounded-xl shadow-2xl border border-gray-700">
          <div id="bus-info" class="text-center mb-6"></div>

          <!-- ‚úÖ AJOUTER CE BLOC HTML ICI -->
          <div id="trip-occupancy-info" class="trip-occupancy-info" style="display: none;">
            <!-- Le contenu sera g√©n√©r√© par JavaScript -->
          </div>
          <div class="bg-gray-700/60 p-4 rounded-lg border border-gray-600 overflow-x-auto">
            <div id="pro-seat-grid" class="min-w-[320px] mx-auto"></div>
          </div>
          <div class="mt-6 flex flex-col md:flex-row justify-between items-center gap-6">
            <div class="flex flex-wrap justify-center items-center gap-x-4 gap-y-2 text-white text-sm">
              <div class="flex items-center gap-2">
                <div class="w-4 h-4 rounded-sm bg-green-500"></div>
                <span data-i18n="seats_legend_available">Disponible</span>
              </div>
              <div class="flex items-center gap-2">
                <div class="w-4 h-4 rounded-sm bg-blue-500"></div>
                <span data-i18n="seats_legend_selected">S√©lectionn√©</span>
              </div>
              <div class="flex items-center gap-2">
                <div class="w-4 h-4 rounded-sm bg-gray-500"></div>
                <span data-i18n="seats_legend_occupied">Occup√©</span>
              </div>
            </div>
            <div class="w-full md:w-auto flex flex-col items-center gap-4">
              <div class="text-white text-center">
                <span data-i18n="seats_summary_seats">Si√®ges :
                  <strong id="selected-seats-display" class="text-blue-400"
                    data-i18n="seats_summary_none">Aucun</strong>
                </span>
                <span data-i18n="seats_summary_price">Prix :
                  <strong id="total-price-display" class="text-green-400">0 FCFA</strong>
                </span>

              </div>
              <button class="btn btn-primary btn-large w-full" onclick="proceedToPassengerInfo()"
                data-i18n="continue_button">
                Continuer
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="passengers-page" class="page">
      <!-- ... (Contenu de la page passagers, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <button class="btn btn-secondary" onclick="showPage('seats')" data-i18n="passengers_back_button">
            ‚Üê Retour
          </button>
          <h2 data-i18n="passengers_title">Informations passagers</h2>
        </div>
        <div id="passengers-forms" class="passengers-forms"></div>
        <div id="baggage-section" class="content-card" style="margin-top: 32px">
          <h3 data-i18n="baggage_title">Bagages Suppl√©mentaires</h3>
          <p id="baggage-section-info" style="margin-bottom: 1rem"></p>
          <div id="baggage-options"></div>
        </div>
        <div class="page-actions" style="
              display: flex;
              justify-content: space-between;
              margin-top: 32px;
            ">
          <button class="btn btn-secondary" onclick="showPage('seats')" data-i18n="passengers_back_button_alt">
            Retour
          </button>
          <button class="btn btn-primary" onclick="proceedToPayment()" data-i18n="passengers_continue_button">
            Continuer vers paiement
          </button>
        </div>
      </div>
    </div>

    <div id="payment-page" class="page">
      <!-- ... (Contenu de la page de paiement, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <button class="btn btn-secondary" onclick="showPage('passengers')" data-i18n="payment_back_button">
            ‚Üê Retour
          </button>
          <h2 data-i18n="payment_title">Paiement</h2>
        </div>
        <div class="payment-container">
          <div class="booking-summary-card">
            <h3 data-i18n="payment_summary_title">R√©capitulatif</h3>
            <!-- ‚úÖ AJOUTER CE BLOC HTML ICI -->
            <div id="urgency-box" class="urgency-box" style="display: none;">
              <!-- Contenu g√©n√©r√© par JavaScript -->
            </div>
            <div id="booking-summary" class="booking-details"></div>
          </div>
          <div class="payment-methods-card">
            <h3 data-i18n="payment_method_title">üí≥ Mode de paiement</h3>
            <div class="payment-methods">
              <label class="payment-method">
                <input type="radio" name="payment" value="mtn" checked />
                <div class="method-content">
                  <div class="method-icon">üì±</div>
                  <div class="method-info">
                    <strong>MTN Mobile Money <span class="method-badge"
                        data-i18n="payment_badge_fast">Rapide</span></strong>
                    <span data-i18n="payment_mtn_desc">‚ö° Paiement instantan√© via MTN</span>
                  </div>
                </div>
              </label>
              <div class="payment-details-form" id="mtn-details">
                <div class="form-group">
                  <label for="mtn-phone" data-i18n="payment_phone_label">üìû Num√©ro de t√©l√©phone MTN</label>
                  <input type="tel" id="mtn-phone" class="form-control" data-i18n="payment_phone_placeholder_mtn" placeholder="Ex: 06 123 4567" />
                </div>
                <div class="form-group">
                  <label for="mtn-amount" data-i18n="payment_amount_label">üí∞ Montant √† payer</label>
                  <input type="text" id="mtn-amount" class="form-control" readonly />
                </div>
                <div class="form-group">
                  <label for="mtn-booking-ref" data-i18n="payment_ref_label">üé´ R√©f√©rence de r√©servation</label>
                  <input type="text" id="mtn-booking-ref" class="form-control" readonly />
                </div>
              </div>
              <label class="payment-method">
                <input type="radio" name="payment" value="airtel" />
                <div class="method-content">
                  <div class="method-icon">üì±</div>
                  <div class="method-info">
                    <strong data-i18n="payment_airtel_name">Airtel Money</strong>
                    <span data-i18n="payment_airtel_desc">‚ö° Paiement instantan√© via Airtel</span>
                  </div>
                </div>
              </label>
              <div class="payment-details-form" id="airtel-details" style="display: none">
                <div class="form-group">
                  <label for="airtel-phone" data-i18n="payment_phone_label_airtel">üìû Num√©ro de t√©l√©phone Airtel</label>
                  <input type="tel" id="airtel-phone" class="form-control" data-i18n="payment_phone_placeholder_airtel" placeholder="Ex: 05 123 4567" />
                </div>
                <div class="form-group">
                  <label for="airtel-amount" data-i18n="payment_amount_label">üí∞ Montant √† payer</label>
                  <input type="text" id="airtel-amount" class="form-control" readonly />
                </div>
                <div class="form-group">
                  <label for="airtel-booking-ref" data-i18n="payment_ref_label">üé´ R√©f√©rence de r√©servation</label>
                  <input type="text" id="airtel-booking-ref" class="form-control" readonly />
                </div>
              </div>
              <label class="payment-method" id="agency-payment-option">
                <input type="radio" name="payment" value="agency" />
                <div class="method-content">
                  <div class="method-icon">üè¢</div>
                  <div class="method-info">
                    <strong data-i18n="payment_agency_name">Paiement √† l'agence</strong>
                    <span id="agency-payment-subtitle" data-i18n="payment_agency_desc">‚è∞ Payez dans les 10h √†
                      l'agence</span>
                  </div>
                </div>
              </label>
              <div class="payment-details-form" id="agency-details" style="display: none">
                <div class="agency-info-box">
                  <h4 data-i18n="payment_agency_nearest">üìç Agence la plus proche</h4>
                  <div id="selected-agency-info"></div>
                </div>
                <div class="form-group">
                  <label data-i18n="payment_agency_deadline">‚è∞ Vous devez payer avant :</label>
                  <input type="text" id="agency-deadline" class="form-control" readonly />
                </div>
                <div class="form-group">
                  <label data-i18n="payment_agency_ref">üìã R√©f√©rence de r√©servation</label>
                  <input type="text" id="agency-booking-ref" class="form-control" readonly />
                </div>
                <div class="info-note">
                  <strong data-i18n="payment_agency_important">‚ö†Ô∏è Important :</strong>
                  <ul style="margin: 10px 0 0 20px; font-size: 14px">
                    <li data-i18n="payment_agency_rule1">Cette r√©servation sera <strong>automatiquement annul√©e</strong>
                      si le paiement n'est pas effectu√© dans les 10h</li>
                    <li data-i18n="payment_agency_rule2">Pr√©sentez-vous √† l'agence avec une pi√®ce d'identit√©</li>
                    <li data-i18n="payment_agency_rule3">Le num√©ro de r√©servation sera requis</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="page-actions">
          <button class="btn btn-secondary" onclick="showPage('passengers')"
            data-i18n="payment_back_button_alt">Retour</button>
          <button class="btn btn-primary btn-large" onclick="confirmBooking(this)"
            data-i18n="payment_confirm_button">Confirmer la R√©servation</button>
        </div>
      </div>
    </div>

    <div id="payment-instructions-page" class="page">
      <!-- Contenu g√©n√©r√© par JS -->
      <div class="container"></div>
    </div>

    <!-- ‚úÖ STRUCTURE CORRIG√âE DE LA PAGE DE CONFIRMATION -->
    <div id="confirmation-page" class="page">
      <div class="container">
        <div class="confirmation-container-modern">
          <!-- Titres et animation de succ√®s -->
          <div class="success-animation">
            <div class="success-checkmark">
              <div class="check-icon">
                <span class="icon-line line-tip"></span><span class="icon-line line-long"></span>
                <div class="icon-circle"></div>
                <div class="icon-fix"></div>
              </div>
            </div>
          </div>
         <h1 class="confirmation-title" data-i18n="confirmation_title">R√©servation confirm√©e !</h1>
<p class="confirmation-subtitle" data-i18n="confirmation_subtitle">
    Votre billet a √©t√© r√©serv√© avec succ√®s
</p>

          <!-- Carte principale qui contiendra les billets -->
          <div class="confirmation-card-modern">
            <!-- En-t√™te commun avec le num√©ro de r√©servation -->
            <div class="confirmation-header">
              <div class="booking-badge">
                <span class="badge-label" data-i18n="confirmation_booking_number">N¬∞ de r√©servation</span>
                <span id="booking-number-display" class="badge-number"></span>
              </div>
              <div class="status-badge status-confirmed">
                <span class="status-icon">‚úì</span>
                <span data-i18n="confirmation_status_confirmed">Confirm√©</span>
              </div>
            </div>

            <!-- Conteneur pour le billet ALLER (g√©n√©r√© par JS) -->
            <div id="outbound-ticket-section"></div>

            <!-- Conteneur pour le billet RETOUR (g√©n√©r√© par JS et cach√© par d√©faut) -->
            <div id="return-ticket-section" style="
                  display: none;
                  margin-top: 40px;
                  padding-top: 30px;
                  border-top: 3px dashed var(--color-border);
                "></div>

            <!-- Informations importantes (d√©plac√© ici) -->
            <div class="info-cards" style="margin-top: 24px">
              <div class="info-card info-card-warning">
                <div class="info-icon">‚è∞</div>
                <div class="info-content">
                  <h4 data-i18n="info_arrive_early_title">Arrivez √† l'avance</h4>
                <p data-i18n="info_arrive_early_desc">
                    Pr√©sentez-vous <strong>30 minutes avant le d√©part</strong> avec une pi√®ce d'identit√© valide
                </p>
                </div>
              </div>
              <div class="info-card info-card-info">
                <div class="info-icon">üéí</div>
                <div class="info-content">
                   <h4 data-i18n="info_baggage_title">Bagages inclus</h4>
                <p data-i18n="info_baggage_desc">1 bagage en soute (20kg) + 1 bagage √† main</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Conteneur pour les boutons d'action (g√©n√©r√© par JS) -->
          <div class="confirmation-actions-modern" id="confirmation-actions-container"></div>

          <!-- Footer de la page de confirmation -->
          <div class="confirmation-footer">
             <p data-i18n="confirmation_help">Besoin d'aide ? Contactez-nous :</p>
            <div class="contact-links">
              <a href="tel:+242061234567">üìû +242 06 123 4567</a>
              <a href="mailto:contact@en-bus.com">üìß contact@en-bus.com</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="reservations-page" class="page">
      <div class="container">
        <div class="page-header">
          <h2 data-i18n="my_bookings_title">Mes R√©servations</h2>
        </div>
        <div id="reservations-list" class="reservations-list"></div>
      </div>
    </div>

    <div id="about-page" class="page">
      <!-- ... (Contenu de la page √Ä Propos, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <h2 data-i18n="about_title">√Ä propos d'En-Bus</h2>
        </div>
        <div class="content-card">
          <p data-i18n="about_intro">

            En-Bus est la plateforme de r√©servation de billets de bus en ligne
            pour l'Afrique. Notre mission est de rendre les voyages en bus
            plus accessibles et plus faciles pour tous.
          </p>
          <h3 data-i18n="about_vision_title">Notre vision</h3>
          <p data-i18n="about_vision_desc">

            Connecter les grandes villes d'Afrique et faciliter les
            d√©placements des populations √† travers le continent.
          </p>
            <h3 data-i18n="about_partners_title">Nos partenaires</h3>
          <ul>
            <li>Oc√©an du Nord</li>
            <li>Trans Bony Voyage</li>
            <li>Stellimac</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="contact-page" class="page">
      <!-- ... (Contenu de la page Contact, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <h2 data-i18n="contact_title">Contact</h2>
        </div>
        <div class="content-card">
           <h3 data-i18n="contact_header">Contactez-nous</h3>
          <p data-i18n="contact_intro">
            Pour toute question ou assistance, n'h√©sitez pas √† nous contacter
            :
          </p>
          <div class="contact-info">
            <div class="contact-item">
              <strong>üìß Email:</strong> <span>contact@en-bus.com</span>
            </div>
            <div class="contact-item">
              <strong>üì± T√©l√©phone:</strong> <span>+242 06 123 4567</span>
            </div>
            <div class="contact-item">
              <strong>üìç Si√®ge Social:</strong>
              <span data-i18n="contact_hq">Brazzaville, R√©publique du Congo</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <!-- ... (votre footer est correct et reste inchang√©) ... -->
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>En-Bus</h4>
          <p data-i18n="footer_tagline">Voyagez √† travers l'Afrique en toute simplicit√©</p>
        </div>
        <div class="footer-section">
           <h4 data-i18n="footer_quicklinks">Liens rapides</h4>
          <a href="#" onclick="showPage('home')" data-i18n="nav_home">Accueil</a>
          <a href="#" onclick="showPage('reservations')" data-i18n="nav_my_bookings">Mes R√©servations</a>
          <a href="#" onclick="showPage('about')" data-i18n="nav_about">√Ä propos</a>
        </div>
        <div class="footer-section">
          <h4 data-i18n="contact_title">Contact</h4>
          <p>Email: contact@en-bus.com</p>
          <p>T√©l: +242 06 123 4567</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p data-i18n="footer_copyright">&copy; 2025 En-Bus. Tous droits r√©serv√©s.</p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://npmcdn.com/flatpickr/dist/l10n/fr.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs2@0.0.2/qrcode.min.js"></script>
  <script src="translations.js"></script>
  <script src="app.js"></script>

  <script>
    // ... (votre script PWA est correct et reste inchang√©) ...
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("/sw.js")
          .then((registration) => {
            console.log("‚úÖ Service Worker enregistr√©:", registration.scope);
            registration.addEventListener("updatefound", () => {
              const newWorker = registration.installing;
              newWorker.addEventListener("statechange", () => {
                if (
                  newWorker.state === "installed" &&
                  navigator.serviceWorker.controller
                ) {
                  if (
                    confirm(
                      "Une nouvelle version est disponible ! Voulez-vous mettre √† jour ?"
                    )
                  ) {
                    newWorker.postMessage({ type: "SKIP_WAITING" });
                    window.location.reload();
                  }
                }
              });
            });
          })
          .catch((error) => {
            console.error("‚ùå Erreur Service Worker:", error);
          });
      });
      let refreshing;
      navigator.serviceWorker.addEventListener("controllerchange", () => {
        if (refreshing) return;
        refreshing = true;
        window.location.reload();
      });
    }
    let deferredPrompt;
    window.addEventListener("beforeinstallprompt", (e) => {
      e.preventDefault();
      deferredPrompt = e;
      showInstallButton();
    });
    function showInstallButton() {
      const installBtn = document.createElement("button");
      installBtn.className = "install-pwa-btn";
      installBtn.innerHTML = `<span style="font-size: 20px;">üì±</span><span>Installer l'application</span>`;
      installBtn.onclick = async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log(`Installation: ${outcome}`);
        if (outcome === "accepted") {
          installBtn.style.display = "none";
        }
        deferredPrompt = null;
      };
      document.body.appendChild(installBtn);
      setTimeout(() => {
        installBtn.classList.add("show");
      }, 2000);
    }
    if (
      window.matchMedia("(display-mode: standalone)").matches ||
      window.navigator.standalone
    ) {
      console.log("‚úÖ Application install√©e et lanc√©e en mode standalone");
      document.body.classList.add("pwa-installed");
    }
    window.addEventListener("online", () => {
      if (typeof Utils !== "undefined")
        Utils.showToast("Connexion r√©tablie", "success");
    });
    window.addEventListener("offline", () => {
      if (typeof Utils !== "undefined")
        Utils.showToast("Mode hors-ligne activ√©", "warning");
    });
  </script>





  <!-- ============================================
       üîÑ MODALE DE REPORT DE VOYAGE
       ============================================ -->
  <div id="report-modal" class="modal">
    <div class="modal-dialog" style="max-width: 700px;">
      <div class="modal-header">
        <h2 id="report-modal-title" class="modal-title">Reporter votre voyage</h2>
        <button class="modal-close" onclick="closeReportModal()">&times;</button>
      </div>
      <div id="report-modal-body" class="modal-body">
        <!-- Contenu g√©n√©r√© dynamiquement -->
      </div>
    </div>
  </div>

  <!-- DANS index.html, juste avant </body> -->

  <!-- ============================================
     ‚úÖ MODALE DE CONFIRMATION PERSONNALIS√âE
     ============================================ -->
  <div id="custom-confirm-modal" class="custom-modal-overlay" style="display: none;">
    <div class="custom-modal-card">
      <div class="custom-modal-header">
        <span id="custom-confirm-icon" class="custom-modal-icon"></span>
        <h3 id="custom-confirm-title"></h3>
      </div>
      <div class="custom-modal-body">
        <p id="custom-confirm-message"></p>
      </div>
      <div class="custom-modal-footer">
        <button id="custom-confirm-cancel-btn" class="btn btn-secondary">Annuler</button>
        <button id="custom-confirm-ok-btn" class="btn btn-danger">Confirmer</button>
      </div>
    </div>
  </div>





</body>

</html>