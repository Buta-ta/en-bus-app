<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="dark" />
  <title>En-Bus - Voyagez √† travers l'Afrique</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Exo+2:wght@300;400;600;700&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <link rel="stylesheet" href="https://npmcdn.com/flatpickr/dist/themes/dark.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <!-- ‚úÖ LEAFLET ROUTING MACHINE (CSS & JS) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#73d700" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="En-Bus" />
  <meta name="description"
    content="R√©servez vos billets de bus en ligne facilement et rapidement √† travers l'Afrique" />
  <meta name="keywords" content="bus, transport, afrique, r√©servation, billet, voyage" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/icons/icon-192x192.png" />
  <meta name="msapplication-TileColor" content="#73d700" />
  <meta name="msapplication-TileImage" content="/icons/icon-192x192.png" />

  <style>
    .seat-selected-anim {
      animation: pulse 0.6s cubic-bezier(0.4, 0, 0.6, 1) 1;
    }

    @keyframes pulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.15);
      }
    }

    /* Ajout des styles pour la PWA - vous pouvez les garder dans style.css aussi */
    .reservation-card-pwa {
      background-color: var(--color-surface);
      border: 1px solid var(--color-border);
      border-left: 4px solid var(--color-accent-glow);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-16);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      animation: fadeIn 0.5s ease-out;
    }

    .res-pwa-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: rgba(var(--color-background-rgb), 0.5);
      padding: var(--space-12) var(--space-16);
      font-weight: 600;
    }

    .res-pwa-booking-number {
      font-family: var(--font-mono, monospace);
      color: var(--color-text-secondary);
    }

    .res-pwa-status {
      font-weight: 700;
    }

    .res-pwa-body {
      padding: var(--space-16);
    }

    .res-pwa-body h4 {
      font-family: var(--font-logo, sans-serif);
      font-size: 1.25rem;
      margin-bottom: var(--space-8);
      color: var(--color-text-primary);
    }

    .res-pwa-body p {
      color: var(--color-text-secondary);
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .res-pwa-actions {
      padding: var(--space-16);
      background-color: rgba(var(--color-background-rgb), 0.7);
      border-top: 1px solid var(--color-border);
      display: flex;
      gap: var(--space-12);
    }

    .res-pwa-actions .btn {
      width: auto;
      flex-grow: 1;
    }

    .loading-spinner {
      text-align: center;
      padding: 48px;
      font-size: 1.2rem;
      color: var(--color-text-secondary);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* DANS index.html, dans la balise <style> */

    .btn-delete-local {
      background: none;
      border: none;
      color: var(--color-text-secondary);
      font-size: 1.2rem;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 50%;
      transition: all 0.2s;
      margin-left: auto;
      /* Pousse le bouton vers la droite */
      margin-right: 10px;
    }

    .btn-delete-local:hover {
      background-color: rgba(244, 67, 54, 0.2);
      color: #f44336;
    }




    /* DANS index.html, dans <style> */

    .trip-occupancy-info {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 16px;
      background-color: rgba(var(--color-accent-glow-rgb), 0.1);
      border: 1px solid var(--color-border);
      padding: 12px 20px;
      border-radius: var(--radius-lg);
      margin: 0 auto 24px;
      max-width: 500px;
      font-size: 14px;
      font-weight: 600;
      color: var(--color-text-secondary);
    }

    .trip-occupancy-info span strong {
      color: var(--color-accent-glow);
      font-size: 16px;
    }

    .trip-occupancy-info .danger {
      color: #ffa726;
      /* Orange pour attirer l'attention */
    }



    /* DANS index.html, dans <style> */

    .urgency-box {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1px;
      background-color: var(--color-border);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      overflow: hidden;
      margin-bottom: 24px;
    }

    .urgency-item {
      background-color: var(--color-surface);
      padding: 16px;
      text-align: center;
    }

    .urgency-label {
      display: block;
      font-size: 12px;
      color: var(--color-text-secondary);
      margin-bottom: 8px;
      text-transform: uppercase;
    }

    .urgency-value {
      display: block;
      font-size: 24px;
      font-weight: 700;
      font-family: var(--font-mono, monospace);
      color: var(--color-text-primary);
    }

    .urgency-value.danger {
      color: #f44336;
      animation: pulse-danger 1.5s infinite;
    }

    @keyframes pulse-danger {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.1);
      }
    }
  </style>
</head>

<body>
  <nav class="navbar">
  <div class="container">
    <div class="nav-content">
      
      <!-- 1. GAUCHE : Tous les liens de navigation (Desktop) -->
      <div class="nav-links desktop-links">
        <a href="#" onclick="showPage('home')" data-i18n="nav_home">Accueil</a>
        <a href="#" onclick="showPage('reservations')" data-i18n="nav_my_bookings">Mes R√©servations</a>
        <a href="#" onclick="showPage('about')" data-i18n="nav_about">√Ä propos</a>
        <a href="#" onclick="showPage('contact')" data-i18n="nav_contact">Contact</a>
      </div>
      
      <!-- 2. DROITE : Logo -->
      <div class="logo" onclick="showPage('home')">
        <svg class="logo-svg animated-logo" width="44" height="44" viewBox="0 0 120 120"
            xmlns="http://www.w3.org/2000/svg" aria-label="Logo En-Bus">
            <defs>
              <radialGradient id="sunGrad" cx="50%" cy="50%" r="50%">
                <stop offset="0%" stop-color="#FFD86B" />
                <stop offset="55%" stop-color="#FF9B39" />
                <stop offset="100%" stop-color="#FF4B2B" />
              </radialGradient>
              <linearGradient id="winGrad" x1="0" x2="1" y1="0" y2="0">
                <stop offset="0%" stop-color="#CDE8FF" />
                <stop offset="100%" stop-color="#A9D2FF" />
              </linearGradient>
              <filter id="softGlow" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur stdDeviation="2" result="blur" />
                <feMerge>
                  <feMergeNode in="blur" />
                  <feMergeNode in="SourceGraphic" />
                </feMerge>
              </filter>
            </defs>
            <circle cx="60" cy="60" r="54" fill="url(#sunGrad)" class="sun-pulse" />
            <rect x="0" y="80" width="120" height="10" fill="#0B0F17" opacity="0.9" />
            <rect x="0" y="90" width="120" height="10" fill="#0B0F17" opacity="0.95" />
            <g class="road-lines" stroke="#F0F5F9" stroke-width="2" opacity="0.6" filter="url(#softGlow)">
              <line x1="12" y1="70" x2="36" y2="70" class="line-1" />
              <line x1="10" y1="74" x2="34" y2="74" class="line-2" />
              <line x1="8" y1="78" x2="32" y2="78" class="line-3" />
            </g>
            <g class="bus-moving" transform="translate(20,52)">
              <rect x="0" y="6" width="80" height="26" rx="5" fill="#F0F5F9" stroke="#0A0F15" stroke-width="2" />
              <path d="M64 6 L78 6 L80 22 L64 22 Z" fill="url(#winGrad)" stroke="#0A0F15" stroke-width="2" />
              <rect x="6" y="10" width="12" height="10" rx="2" fill="url(#winGrad)" stroke="#0A0F15"
                stroke-width="1.5" />
              <rect x="20" y="10" width="12" height="10" rx="2" fill="url(#winGrad)" stroke="#0A0F15"
                stroke-width="1.5" />
              <rect x="34" y="10" width="12" height="10" rx="2" fill="url(#winGrad)" stroke="#0A0F15"
                stroke-width="1.5" />
              <rect x="48" y="10" width="12" height="10" rx="2" fill="url(#winGrad)" stroke="#0A0F15"
                stroke-width="1.5" />
              <rect x="8" y="18" width="10" height="14" rx="1.5" fill="#E7EDF3" stroke="#0A0F15" stroke-width="1.5" />
              <circle cx="78" cy="24" r="2.8" fill="#FFEAA7" stroke="#0A0F15" stroke-width="1" class="headlight" />
              <rect x="0" y="28" width="80" height="4" fill="#E1E7EE" stroke="#0A0F15" stroke-width="1" />
              <g class="wheels">
                <circle cx="18" cy="36" r="6.8" fill="#0A0F15" class="wheel-outer" />
                <circle cx="18" cy="36" r="3.2" fill="#9AA5B1" class="wheel-inner" />
                <circle cx="62" cy="36" r="6.8" fill="#0A0F15" class="wheel-outer" />
                <circle cx="62" cy="36" r="3.2" fill="#9AA5B1" class="wheel-inner" />
              </g>
            </g>
          </svg>
        <span class="logo-text">En-Bus</span>
      </div>

      <!-- 3. DROITE : Boutons langues (Desktop) -->
      <div class="language-selector desktop-only">
        <button class="lang-btn" onclick="changeLanguage('fr')" aria-label="Fran√ßais">üá´üá∑</button>
        <button class="lang-btn" onclick="changeLanguage('en')" aria-label="English">üá¨üáß</button>
      </div>
      
      <!-- 4. HAMBURGER : Mobile uniquement -->
      <button id="hamburger-btn" class="hamburger" aria-label="Ouvrir le menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>

    </div>
    
    <!-- Menu Mobile -->
    <div id="mobile-nav-menu" class="mobile-nav">
      <a href="#" onclick="closeMenuAndShowPage('home')" data-i18n="nav_home">Accueil</a>
      <a href="#" onclick="closeMenuAndShowPage('reservations')" data-i18n="nav_my_bookings">Mes R√©servations</a>
      <a href="#" onclick="closeMenuAndShowPage('about')" data-i18n="nav_about">√Ä propos</a>
      <a href="#" onclick="closeMenuAndShowPage('contact')" data-i18n="nav_contact">Contact</a>
      
      <!-- Langues dans le menu mobile -->
      <div class="mobile-lang-selector">
        <button class="lang-btn" onclick="changeLanguage('fr')" aria-label="Fran√ßais">üá´üá∑ Fran√ßais</button>
        <button class="lang-btn" onclick="changeLanguage('en')" aria-label="English">üá¨üáß English</button>
      </div>
    </div>
  </div>
</nav>

  <main>
    <!-- Toutes les pages de l'application -->
    <div id="home-page" class="page active">
      <!-- ... (Contenu de la page d'accueil, inchang√©) ... -->
      <section class="hero">
        <div class="container">
          <div class="hero-content">

            <!-- ‚úÖ Cl√©s de traduction ajout√©es -->
            <h1 data-i18n="hero_title">Voyagez √† travers l'Afrique</h1>
            <p data-i18n="hero_subtitle">
              R√©servez vos billets de bus en ligne facilement et rapidement
            </p>



            <!-- ============================================= -->
            <!-- ‚úÖ 1. AJOUTER LA NOUVELLE BARRE DE RECHERCHE -->
            <!-- ============================================= -->
            <div id="smart-search-container" class="smart-search-wrapper">
              <div class="smart-search-input-wrapper">
                <input type="text" id="smart-search-input" placeholder="O√π voulez-vous aller ?" autocomplete="off">
                <button id="smart-search-submit-btn" aria-label="Lancer la recherche">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24"
                    height="24">
                    <path
                      d="M10 18a7.952 7.952 0 0 0 4.897-1.688l4.396 4.396 1.414-1.414-4.396-4.396A7.952 7.952 0 0 0 18 10c0-4.411-3.589-8-8-8s-8 3.589-8 8 3.589 8 8 8zm0-14c3.309 0 6 2.691 6 6s-2.691 6-6 6-6-2.691-6-6 2.691-6 6-6z">
                    </path>
                  </svg>
                </button>
              </div>
              <!-- ‚úÖ ASSUREZ-VOUS QUE CE DIV EST BIEN L√Ä -->
              <div id="smart-search-results"></div>
            </div>

            <!-- ================================================ -->
            <!-- ‚úÖ FORMULAIRE D√âTAILL√â CORRIG√â ET FUSIONN√â -->
            <!-- ================================================ -->
            <div id="detailed-search-box" class="search-box"> <!-- Un seul div avec le bon ID -->
              <div class="search-form">
                <!-- ‚úÖ On utilise le nouveau conteneur que le CSS va reconna√Ætre -->
                <div class="destination-swap-container">

                  <div class="form-group">
                    <label for="origin" data-i18n="search_form_origin">Ville de d√©part</label>
                    <select id="origin" class="form-control"></select>
                  </div>

                  <button type="button" id="swap-destinations-btn" class="swap-btn" title="Inverser les destinations">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"></path>
                    </svg>
                  </button>

                  <div class="form-group">
                    <label for="destination" data-i18n="search_form_destination">Ville d'arriv√©e</label>
                    <select id="destination" class="form-control"></select>
                  </div>

                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label data-i18n="search_form_trip_type">Type de voyage</label>
                    <div class="trip-type-toggle" data-mode="one-way">
                      <label class="toggle-option active" data-value="one-way" data-i18n="search_form_one_way">Aller
                        simple</label>
                      <label class="toggle-option" data-value="round-trip"
                        data-i18n="search_form_round_trip">Aller-retour</label>
                      <div class="toggle-switch"></div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="travel-date" data-i18n="search_form_dates">Dates du voyage</label>
                    <input type="text" id="travel-date" class="form-control" data-i18n="search_form_dates_placeholder"
                      placeholder="S√©lectionnez vos dates" />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label data-i18n="search_form_passengers">Passagers</label>
                    <div id="passenger-input" class="form-control passenger-selector">
                      <span id="passenger-summary">1 Adulte</span>
                    </div>
                    <div id="passenger-dropdown" class="passenger-dropdown-menu">
                      <div class="passenger-row">
                        <label data-i18n="search_form_adults">Adultes</label>
                        <div class="passenger-counter">
                          <button type="button" class="counter-btn" data-type="adults"
                            data-action="decrement">-</button>
                          <span id="adults-count">1</span>
                          <button type="button" class="counter-btn" data-type="adults"
                            data-action="increment">+</button>
                        </div>
                      </div>
                      <div class="passenger-row">
                        <label data-i18n="search_form_children">Enfants <small>(0-6 ans)</small></label>
                        <div class="passenger-counter">
                          <button type="button" class="counter-btn" data-type="children"
                            data-action="decrement">-</button>
                          <span id="children-count">0</span>
                          <button type="button" class="counter-btn" data-type="children"
                            data-action="increment">+</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <button class="btn btn-primary btn-large" onclick="searchBuses()"
                  data-i18n="search_form_button">Rechercher</button>
              </div>
            </div>

          </div>
        </div>
      </section>
      <section class="popular-destinations">
        <div class="container">
          <h2 data-i18n="popular_destinations_title">Destinations populaires</h2>
          <div class="destinations-grid" id="popular-destinations-grid"></div>
        </div>
      </section>
      <section class="why-en-bus">
        <div class="container">
          <h2 data-i18n="why_en_bus_title">Pourquoi choisir En-Bus ?</h2>
          <div class="features-grid">
            <div class="feature-card">
              <div class="feature-icon">üì±</div>
              <h3 data-i18n="feature_easy_booking">R√©servation facile</h3>
              <p data-i18n="feature_easy_booking_desc">R√©servez vos billets en quelques clics</p>

            </div>
            <div class="feature-card">
              <div class="feature-icon">üí∞</div>
              <h3 data-i18n="feature_best_prices">Meilleurs prix</h3>
              <p data-i18n="feature_best_prices_desc">Trouvez les meilleures offres</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">üöå</div>
              <h3 data-i18n="feature_comfort">Confort garanti</h3>
              <p data-i18n="feature_comfort_desc">Voyagez avec les meilleures compagnies</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">üîí</div>
              <h3 data-i18n="feature_security">S√©curit√© maximale</h3>
              <p data-i18n="feature_security_desc">Vos informations sont s√©curis√©es</p>
            </div>
          </div>
        </div>
      </section>



      <!-- ============================================ -->
      <!-- ‚úÖ NOUVELLE SECTION POUR LA CARTE -->
      <!-- ============================================ -->
      <section class="map-section">
        <div class="container">
          <h2 data-i18n="map_section_title">Notre R√©seau en un coup d'≈ìil</h2>

          <!-- C'est ce div que Leaflet utilisera pour dessiner la carte -->
          <div id="interactive-map"></div>
        </div>
      </section>


    </div>

    <div id="results-page" class="page">
      <!-- ... (Contenu de la page des r√©sultats, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <button class="btn btn-secondary" onclick="showPage('home')" data-i18n="results_back_button">
            ‚Üê Retour
          </button>
          <h2 data-i18n="results_title">R√©sultats de recherche</h2>
        </div>
        <div id="search-summary" class="search-summary"></div>
        <div class="filters-bar-enhanced">

          <!-- ... (filtre "Trier par" et "Compagnie" restent inchang√©s) ... -->

          <!-- ‚úÖ NOUVEAU FILTRE PAR LIEU DE D√âPART -->
          <div id="departure-location-filter-section" class="filter-section" style="display: none;">
            <label for="filter-departure-location" class="filter-label" data-i18n="filter_departure_location">
              <span class="filter-icon">üìç</span>
              Lieu de d√©part :
            </label>
            <select id="filter-departure-location" class="filter-select"
              onchange="updateFilter('departureLocation', this.value)">
              <!-- Les options seront g√©n√©r√©es dynamiquement par JavaScript -->
            </select>
          </div>

          <div class="filter-section">
            <label for="sort-by" class="filter-label" data-i18n="filter_sort_by">
              <span class="filter-icon">üîΩ</span> Trier par :
            </label>
            <select id="sort-by" class="filter-select" onchange="updateFilter('sortBy', this.value)">
              <option value="departure" data-i18n="sort_by_departure">Heure de d√©part</option>
              <option value="price" data-i18n="sort_by_price">Prix croissant</option>
              <option value="duration" data-i18n="sort_by_duration">Dur√©e du trajet</option>
              <option value="company" data-i18n="sort_by_company">Compagnie (A-Z)</option>
            </select>

          </div>
          <div class="filter-section">
            <label for="filter-company" class="filter-label" data-i18n="filter_company"></label>
            <span class="filter-icon">üöå</span> Compagnie :
            </label>
            <select id="filter-company" class="filter-select" onchange="updateFilter('company', this.value)">
              <option value="all" data-i18n="filter_all">Toutes</option>

              <option value="Oc√©an du Nord">Oc√©an du Nord</option>
              <option value="Trans Bony">Trans Bony</option>
              <option value="Stellimac">Stellimac</option>
              <option value="United Express">United Express</option>
              <option value="Touristique Express">Touristique Express</option>
              <option value="Garantie Express">Garantie Express</option>
              <option value="ABC Transport">ABC Transport</option>
              <option value="STC">STC</option>
            </select>
          </div>
          <div class="filter-section">
            <label for="filter-trip-type" class="filter-label" data-i18n="filter_trip_type">
              <span class="filter-icon">üõ£Ô∏è</span> Type :
            </label>
            <select id="filter-trip-type" class="filter-select" onchange="updateFilter('tripType', this.value)">
              <option value="all" data-i18n="filter_all">Tous</option>
              <option value="direct" data-i18n="filter_type_direct">Direct uniquement</option>
              <option value="stops" data-i18n="filter_type_stops">Avec arr√™ts</option>
              <option value="connections" data-i18n="filter_type_connections">Avec correspondances</option>
            </select>
          </div>
          <div class="filter-section">
            <label for="filter-time" class="filter-label" data-i18n="filter_departure_time">
              <span class="filter-icon">üïê</span> D√©part :
            </label>
            <select id="filter-time" class="filter-select" onchange="updateFilter('departureTime', this.value)">
              <option value="all" data-i18n="filter_time_all">Toute la journ√©e</option>
              <option value="morning" data-i18n="filter_time_morning">Matin (5h-12h)</option>
              <option value="afternoon" data-i18n="filter_time_afternoon">Apr√®s-midi (12h-17h)</option>
              <option value="evening" data-i18n="filter_time_evening">Soir√©e (17h-21h)</option>
              <option value="night" data-i18n="filter_time_night">Nuit (21h-5h)</option>
            </select>
          </div>
          <div class="filter-section filter-price">
            <label class="filter-label" data-i18n="filter_price">
              <span class="filter-icon">üí∞</span> Prix :
            </label>
            <div class="price-range-container">
              <div class="price-inputs">
                <div class="price-input-group">
                  <label for="price-min" class="price-label" data-i18n="filter_price_min">Min</label>
                  <input type="range" id="price-min" min="0" max="100000" step="1000" value="0"
                    oninput="updateFilter('priceMin', this.value)" />
                  <span id="price-min-display" class="price-display">0</span>
                  FCFA
                </div>
                <div class="price-input-group">
                  <label for="price-max" class="price-label" data-i18n="filter_price_max">Max</label>
                  <input type="range" id="price-max" min="0" max="100000" step="1000" value="100000"
                    oninput="updateFilter('priceMax', this.value)" />
                  <span id="price-max-display" class="price-display">100 000</span>
                  FCFA
                </div>
              </div>
            </div>
          </div>
          <div class="filter-section filter-amenities">
            <label class="filter-label" data-i18n="filter_amenities">
              <span class="filter-icon">‚öôÔ∏è</span> √âquipements :
            </label>
            <div class="amenities-checkboxes" id="amenities-filter-container"></div>
          </div>
          <div class="filter-section">
            <button class="btn btn-secondary btn-reset-filters" onclick="resetFilters()"
              data-i18n="filter_reset_button">
              üîÑ R√©initialiser
            </button>
          </div>
        </div>
        <div id="amenities-legend" class="amenities-legend"></div>
        <div id="results-list" class="results-list"></div>
      </div>
    </div>

    <div id="seats-page" class="page">
      <!-- ... (Contenu de la page des si√®ges, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <button class="btn btn-secondary" onclick="showPage('results')" data-i18n="seats_back_button">
            ‚Üê Retour
          </button>
          <h2 data-i18n="seats_title">S√©lection des si√®ges</h2>
        </div>
        <div
          class="max-w-4xl mx-auto bg-gray-800/50 backdrop-blur-sm p-4 sm:p-6 rounded-xl shadow-2xl border border-gray-700">
          <div id="bus-info" class="text-center mb-6"></div>

          <!-- ‚úÖ AJOUTER CE BLOC HTML ICI -->
          <div id="trip-occupancy-info" class="trip-occupancy-info" style="display: none;">
            <!-- Le contenu sera g√©n√©r√© par JavaScript -->
          </div>
          <div class="bg-gray-700/60 p-4 rounded-lg border border-gray-600 overflow-x-auto">
            <div id="pro-seat-grid" class="min-w-[320px] mx-auto"></div>
          </div>
          <div class="mt-6 flex flex-col md:flex-row justify-between items-center gap-6">
            <div class="flex flex-wrap justify-center items-center gap-x-4 gap-y-2 text-white text-sm">
              <div class="flex items-center gap-2">
                <div class="w-4 h-4 rounded-sm bg-green-500"></div>
                <span data-i18n="seats_legend_available">Disponible</span>
              </div>
              <div class="flex items-center gap-2">
                <div class="w-4 h-4 rounded-sm bg-blue-500"></div>
                <span data-i18n="seats_legend_selected">S√©lectionn√©</span>
              </div>
              <div class="flex items-center gap-2">
                <div class="w-4 h-4 rounded-sm bg-gray-500"></div>
                <span data-i18n="seats_legend_occupied">Occup√©</span>
              </div>
            </div>
            <div class="w-full md:w-auto flex flex-col items-center gap-4">
              <div class="text-white text-center">
                <!-- Label pour "Si√®ges" -->
                <span data-i18n="seats_summary_seats">Si√®ges :</span>
                <!-- Valeur pour les num√©ros de si√®ges -->
                <strong id="selected-seats-display" class="text-blue-400"></strong>

                <span class="mx-2">|</span>

                <!-- Label pour "Prix" -->
                <span data-i18n="seats_summary_price">Prix :</span>
                <!-- Valeur pour le montant -->
                <strong id="total-price-display" class="text-green-400"></strong>


              </div>
              <button class="btn btn-primary btn-large w-full" onclick="proceedToPassengerInfo()"
                data-i18n="continue_button">
                Continuer
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="passengers-page" class="page">
      <!-- ... (Contenu de la page passagers, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <button class="btn btn-secondary" onclick="showPage('seats')" data-i18n="passengers_page_back_button">
            ‚Üê Retour
          </button>
          <h2 data-i18n="passengers_page_title">Informations passagers</h2>
        </div>
        <div id="passengers-forms" class="passengers-forms"></div>
        <div id="baggage-section" class="content-card" style="margin-top: 32px">
          <h3 data-i18n="baggage_title">Bagages Suppl√©mentaires</h3>
          <p id="baggage-section-info" style="margin-bottom: 1rem"></p>
          <div id="baggage-options"></div>
        </div>
        <div class="page-actions" style="
              display: flex;
              justify-content: space-between;
              margin-top: 32px;
            ">
          <button class="btn btn-secondary" onclick="showPage('seats')" data-i18n="passengers_back_button">
            Retour
          </button>
          <button class="btn btn-primary" onclick="proceedToPayment()" data-i18n="passengers_continue_button">
            Continuer vers paiement
          </button>
        </div>
      </div>
    </div>

    <div id="payment-page" class="page">
      <!-- ... (Contenu de la page de paiement, inchang√©) ... -->
      <div class="container">
        <div class="page-header">
          <button class="btn btn-secondary" onclick="showPage('passengers')" data-i18n="payment_page_back_button">
            ‚Üê Retour
          </button>
          <h2 data-i18n="payment_page_title">Paiement</h2>
        </div>
        <div class="payment-container">
          <div class="booking-summary-card">
            <h3 data-i18n="payment_summary_title">R√©capitulatif</h3>
            <!-- ‚úÖ AJOUTER CE BLOC HTML ICI -->
            <div id="urgency-box" class="urgency-box" style="display: none;">
              <!-- Contenu g√©n√©r√© par JavaScript -->
            </div>
            <div id="booking-summary" class="booking-details"></div>
          </div>
          <div class="payment-methods-card">
            <h3 data-i18n="payment_method_title">üí≥ Mode de paiement</h3>
            <div class="payment-methods">
              <label class="payment-method">
                <input type="radio" name="payment" value="mtn" checked />
                <div class="method-content">
                  <div class="method-icon">üì±</div>
                  <div class="method-info">
                    <strong>MTN Mobile Money <span class="method-badge"
                        data-i18n="payment_badge_fast">Rapide</span></strong>
                    <span data-i18n="payment_mtn_desc">‚ö° Paiement instantan√© via MTN</span>
                  </div>
                </div>
              </label>
              <div class="payment-details-form" id="mtn-details">
                <div class="form-group">
                  <label for="mtn-phone" data-i18n="payment_phone_label_mtn">üìû Num√©ro de t√©l√©phone MTN</label>
                  <input type="tel" id="mtn-phone" class="form-control" data-i18n="payment_phone_placeholder_mtn"
                    placeholder="Ex: 06 123 4567" />
                </div>
                <div class="form-group">
                  <label for="mtn-amount" data-i18n="payment_amount_label">üí∞ Montant √† payer</label>
                  <input type="text" id="mtn-amount" class="form-control" readonly />
                </div>
                <div class="form-group">
                  <label for="mtn-booking-ref" data-i18n="payment_ref_label">üé´ R√©f√©rence de r√©servation</label>
                  <input type="text" id="mtn-booking-ref" class="form-control" readonly />
                </div>
              </div>
              <label class="payment-method">
                <input type="radio" name="payment" value="airtel" />
                <div class="method-content">
                  <div class="method-icon">üì±</div>
                  <div class="method-info">
                    <strong data-i18n="payment_airtel_name">Airtel Money</strong>
                    <span data-i18n="payment_airtel_desc">‚ö° Paiement instantan√© via Airtel</span>
                  </div>
                </div>
              </label>
              <div class="payment-details-form" id="airtel-details" style="display: none">
                <div class="form-group">
                  <label for="airtel-phone" data-i18n="payment_phone_label_airtel">üìû Num√©ro de t√©l√©phone Airtel</label>
                  <input type="tel" id="airtel-phone" class="form-control" data-i18n="payment_phone_placeholder_airtel"
                    placeholder="Ex: 05 123 4567" />
                </div>
                <div class="form-group">
                  <label for="airtel-amount" data-i18n="payment_amount_label">üí∞ Montant √† payer</label>
                  <input type="text" id="airtel-amount" class="form-control" readonly />
                </div>
                <div class="form-group">
                  <label for="airtel-booking-ref" data-i18n="payment_ref_label">üé´ R√©f√©rence de r√©servation</label>
                  <input type="text" id="airtel-booking-ref" class="form-control" readonly />
                </div>
              </div>
              <label class="payment-method" id="agency-payment-option">
                <input type="radio" name="payment" value="agency" />
                <div class="method-content">
                  <div class="method-icon">üè¢</div>
                  <div class="method-info">
                    <strong data-i18n="payment_agency_name">Paiement √† l'agence</strong>
                    <span id="agency-payment-subtitle" data-i18n="payment_agency_desc">‚è∞ Payez dans les 10h √†
                      l'agence</span>
                  </div>
                </div>
              </label>
              <div class="payment-details-form" id="agency-details" style="display: none">
                <div class="agency-info-box">
                  <!-- ‚úÖ TRADUCTION DU TITRE -->
                  <h4 data-i18n="payment_agency_nearest">üìç Agence la plus proche</h4>
                  <div id="selected-agency-info"></div>
                </div>
                <div class="form-group">
                  <!-- ‚úÖ TRADUCTION DU LABEL -->
                  <label data-i18n="payment_agency_deadline">‚è∞ Vous devez payer avant :</label>
                  <input type="text" id="agency-deadline" class="form-control" readonly />
                </div>
                <div class="form-group">
                  <!-- ‚úÖ TRADUCTION DU LABEL -->
                  <label data-i18n="payment_agency_ref">üìã R√©f√©rence de r√©servation</label>
                  <input type="text" id="agency-booking-ref" class="form-control" readonly />
                </div>
                <div class="info-note">
                  <!-- ‚úÖ TRADUCTION DU TITRE -->
                  <strong data-i18n="payment_agency_important_title">‚ö†Ô∏è Important :</strong>
                  <ul style="margin: 10px 0 0 20px; font-size: 14px">
                    <!-- ‚úÖ Le premier point sera g√©r√© par JS -->
                    <li id="agency-rule1-placeholder"></li>
                    <!-- ‚úÖ TRADUCTION DES R√àGLES STATIQUES -->
                    <li data-i18n="payment_agency_rule2">Pr√©sentez-vous √† l'agence avec une pi√®ce d'identit√©</li>
                    <li data-i18n="payment_agency_rule3">Le num√©ro de r√©servation sera requis</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="page-actions">
          <button class="btn btn-secondary" onclick="showPage('passengers')"
            data-i18n="payment_page_back_button">Retour</button>
          <button class="btn btn-primary btn-large" onclick="confirmBooking(this)"
            data-i18n="payment_confirm_button">Confirmer la R√©servation</button>
        </div>
      </div>
    </div>

    <div id="payment-instructions-page" class="page">
      <!-- Contenu g√©n√©r√© par JS -->
      <div class="container"></div>
    </div>

    <!-- ‚úÖ STRUCTURE CORRIG√âE DE LA PAGE DE CONFIRMATION -->
    <div id="confirmation-page" class="page">
      <div class="container">
        <div class="confirmation-container-modern">
          <!-- Titres et animation de succ√®s -->
          <div class="success-animation">
            <div class="success-checkmark">
              <div class="check-icon">
                <span class="icon-line line-tip"></span><span class="icon-line line-long"></span>
                <div class="icon-circle"></div>
                <div class="icon-fix"></div>
              </div>
            </div>
          </div>
          <h1 class="confirmation-title">R√©servation confirm√©e !</h1>
          <p class="confirmation-subtitle">Votre billet a √©t√© r√©serv√© avec succ√®s</p>

          <!-- Carte principale qui contiendra les billets -->
          <div class="confirmation-card-modern">
            <!-- En-t√™te commun avec le num√©ro de r√©servation -->
            <div class="confirmation-header">
              <div class="booking-badge">
                <span class="badge-label" data-i18n="confirmation_booking_number">N¬∞ de r√©servation</span>
                <span id="booking-number-display" class="badge-number"></span>
              </div>
              <div class="status-badge status-confirmed">
                <span class="status-icon">‚úì</span>
                <span data-i18n="confirmation_status_confirmed">Confirm√©</span>
              </div>
            </div>

            <!-- Conteneur pour le billet ALLER (g√©n√©r√© par JS) -->
            <div id="outbound-ticket-section"></div>

            <!-- Conteneur pour le billet RETOUR (g√©n√©r√© par JS et cach√© par d√©faut) -->
            <div id="return-ticket-section" style="
                  display: none;
                  margin-top: 40px;
                  padding-top: 30px;
                  border-top: 3px dashed var(--color-border);
                "></div>

            <!-- Informations importantes (d√©plac√© ici) -->
            <div class="info-cards" style="margin-top: 24px">
              <div class="info-card info-card-warning">
                <div class="info-icon">‚è∞</div>
                <div class="info-content">
                  <h4 data-i18n="info_arrive_early_title">Arrivez √† l'avance</h4>
                  <p data-i18n="info_arrive_early_desc">
                    Pr√©sentez-vous <strong>30 minutes avant le d√©part</strong> avec une pi√®ce d'identit√© valide
                  </p>
                </div>
              </div>
              <div class="info-card info-card-info">
                <div class="info-icon">üéí</div>
                <div class="info-content">
                  <h4 data-i18n="info_baggage_title">Bagages inclus</h4>
                  <p data-i18n="info_baggage_desc">1 bagage en soute (20kg) + 1 bagage √† main</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Conteneur pour les boutons d'action (g√©n√©r√© par JS) -->
          <div class="confirmation-actions-modern" id="confirmation-actions-container"></div>

          <!-- Footer de la page de confirmation -->
          <div class="confirmation-footer">
            <p data-i18n="confirmation_help">Besoin d'aide ? Contactez-nous :</p>
            <div class="contact-links">
              <a href="tel:+242061234567">üìû +242 06 123 4567</a>
              <a href="mailto:contact@en-bus.com">üìß contact@en-bus.com</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="reservations-page" class="page">
      <div class="container">
        <div class="page-header">
          <h2 data-i18n="my_bookings_title">Mes R√©servations</h2>
        </div>
        <div id="reservations-list" class="reservations-list"></div>
      </div>
    </div>

    <!-- ============================================
     üìÑ PAGE √Ä PROPOS (MODERNE)
     ============================================ -->
<div id="about-page" class="page">
  
  <!-- 1. Section H√©ros Visuelle -->
  <div class="about-hero">
    <div class="container">
      <h1 data-i18n="about_hero_title">Connecter l'Afrique, un voyage √† la fois.</h1>
      <p data-i18n="about_hero_subtitle">Notre mission est de simplifier les voyages en bus sur le continent, en offrant une plateforme fiable, s√©curis√©e et facile √† utiliser.</p>
    </div>
  </div>

  <div class="container">
    
    <!-- 2. Section Mission, Vision, Valeurs -->
    <div class="about-features-grid">
      <div class="feature-card">
        <div class="feature-icon">üéØ</div>
        <h3 data-i18n="about_mission_title">Notre Mission</h3>
        <p data-i18n="about_mission_desc">Rendre la r√©servation de billets de bus en Afrique aussi simple que quelques clics, pour tout le monde, partout.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üî≠</div>
        <h3 data-i18n="about_vision_title">Notre Vision</h3>
        <p data-i18n="about_vision_desc">Devenir la plateforme de r√©f√©rence pour tous les d√©placements terrestres en Afrique, en connectant les villes et les peuples.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">‚ù§Ô∏è</div>
        <h3 data-i18n="about_values_title">Nos Valeurs</h3>
        <p data-i18n="about_values_desc">Confiance, s√©curit√©, simplicit√© et innovation sont au c≈ìur de tout ce que nous faisons.</p>
      </div>
    </div>

    <!-- 3. Section Chiffres Cl√©s -->
    <div class="stats-section">
      <h2 data-i18n="about_stats_title">En-Bus en chiffres</h2>
      <div class="stats-grid">
        <div class="stat-item">
          <span class="stat-number" data-target="50000">0</span>
          <span class="stat-label" data-i18n="about_stats_passengers">Passagers Transport√©s</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" data-target="50">0</span>
          <span class="stat-label" data-i18n="about_stats_destinations">Destinations</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" data-target="15">0</span>
          <span class="stat-label" data-i18n="about_stats_partners">Compagnies Partenaires</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" data-target="98">0</span>
          <span class="stat-label" data-i18n="about_stats_satisfaction">Satisfaction Client (%)</span>
        </div>
      </div>
    </div>

    <!-- 4. Section Partenaires -->
    <div class="partners-section">
      <h2 data-i18n="about_partners_title">Nos compagnies partenaires</h2>
      <div class="logos-container">
        <!-- Remplace par les vrais chemins de tes images -->
        <img src="https://www.ocean-du-nord.com/img/congo_profond.png" alt="Oc√©an du Nord">
        <img src="https://cg.touritouri.com/uploads/image/2025/01/unnamed.jpg" alt="Trans Bony">
        <img src="https://sc04.alicdn.com/kf/H43a002e641e54f108b7a4432b36e7cd4l.jpg" alt="Stellimac">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/Logo_wordmark_United_Express_%282019%29.svg/512px-Logo_wordmark_United_Express_%282019%29.svg.png?20250518143428" alt="United Express">
        <img src="https://ayilaa.s3.eu-west-1.amazonaws.com/attraction/logos/64fa01f73c632_1694106103_BUCAVOYAGE%20(3).jpg" alt="Buca Voyages">
      </div>
    </div>

    <!-- 5. Appel √† l'Action (CTA) -->
    <div class="cta-section">
      <h2 data-i18n="about_cta_title">Pr√™t √† voyager ?</h2>
      <p data-i18n="about_cta_subtitle">Trouvez votre prochain trajet d√®s maintenant.</p>
      <button class="btn btn-primary" onclick="showPage('home')" data-i18n="about_cta_button">Rechercher un billet</button>
    </div>

  </div>
</div>

    <!-- ============================================
     üìû PAGE CONTACT (MODERNE)
     ============================================ -->
<div id="contact-page" class="page">
    <div class="container">
        
        <!-- 1. En-t√™te de la page -->
        <div class="page-header" style="text-align: center; margin-bottom: 3rem;">
            <h1 class="contact-main-title" data-i18n="contact_main_title">Contactez-nous</h1>
            <p class="contact-main-subtitle" data-i18n="contact_main_subtitle">Une question ? Une suggestion ? Notre √©quipe est l√† pour vous aider.</p>
        </div>

        <!-- 2. Conteneur principal (Formulaire + Infos) -->
        <div class="contact-grid">
            
            <!-- Colonne de gauche : Infos de contact -->
            <div class="contact-info-cards">
                <div class="info-card">
                    <div class="info-card-icon">üìß</div>
                    <h3 data-i18n="contact_email_title">Par Email</h3>
                    <p data-i18n="contact_email_desc">Pour toute demande g√©n√©rale ou support.</p>
                    <a href="mailto:contact@en-bus.com" class="info-card-link">contact@en-bus.com</a>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">üìû</div>
                    <h3 data-i18n="contact_phone_title">Par T√©l√©phone</h3>
                    <p data-i18n="contact_phone_desc">Assistance imm√©diate du Lundi au Samedi.</p>
                    <a href="tel:+242061234567" class="info-card-link">+242 06 123 4567</a>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">üìç</div>
                    <h3 data-i18n="contact_hq_title">Si√®ge Social</h3>
                    <p data-i18n="contact_hq_address">Avenue de la R√©publique, Brazzaville, Congo</p>
                </div>
            </div>

            <!-- Colonne de droite : Formulaire de contact -->
            <div class="contact-form-card">
                <h3 data-i18n="contact_form_title">Envoyez-nous un message</h3>
                <form id="contact-form" action="https://formspree.io/f/xrbwjwrj" method="POST">
                    <div class="form-group">
                        <label for="contact-name" data-i18n="contact_form_name">Votre Nom</label>
                        <input type="text" id="contact-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="contact-email" data-i18n="contact_form_email">Votre Email</label>
                        <input type="email" id="contact-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="contact-subject" data-i18n="contact_form_subject">Sujet</label>
                        <select id="contact-subject" class="form-control" required>
                            <option value="general" data-i18n="contact_subject_general">Question g√©n√©rale</option>
                            <option value="booking" data-i18n="contact_subject_booking">Aide √† la r√©servation</option>
                            <option value="partnership" data-i18n="contact_subject_partnership">Partenariat</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="contact-message" data-i18n="contact_form_message">Message</label>
                        <textarea id="contact-message" class="form-control" rows="5" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" data-i18n="contact_form_button">Envoyer le message</button>
                </form>
            </div>
        </div>

        <!-- 3. Section FAQ (Foire Aux Questions) -->
        <div class="faq-section">
            <h2 data-i18n="contact_faq_title">Questions Fr√©quentes</h2>
            <div class="faq-container">
                <div class="faq-item">
                    <button class="faq-question" data-i18n="faq_q1_title">Comment puis-je payer ma r√©servation ?</button>
                    <div class="faq-answer">
                        <p data-i18n="faq_q1_answer">Vous pouvez payer par MTN Mobile Money, Airtel Money, ou directement dans l'une de nos agences partenaires. Toutes les options vous seront propos√©es au moment du paiement.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question" data-i18n="faq_q2_title">Puis-je annuler ou modifier mon billet ?</button>
                    <div class="faq-answer">
                        <p data-i18n="faq_q2_answer">Oui, il est possible de reporter votre voyage sous certaines conditions via la section "Mes R√©servations". Les annulations avec remboursement ne sont g√©n√©ralement pas possibles, mais d√©pendent de la politique de la compagnie de bus.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question" data-i18n="faq_q3_title">Je n'ai pas re√ßu mon billet, que faire ?</button>
                    <div class="faq-answer">
                        <p data-i18n="faq_q3_answer">Apr√®s un paiement confirm√©, votre billet est imm√©diatement disponible dans la section "Mes R√©servations" de l'application. Si vous ne le voyez pas, veuillez v√©rifier le statut de votre paiement ou nous contacter.</p>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
  </main>

  <footer class="footer">
    <!-- ... (votre footer est correct et reste inchang√©) ... -->
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>En-Bus</h4>
          <p data-i18n="footer_tagline">Voyagez √† travers l'Afrique en toute simplicit√©</p>
        </div>
        <div class="footer-section">
          <h4 data-i18n="footer_quicklinks">Liens rapides</h4>
          <a href="#" onclick="showPage('home')" data-i18n="nav_home">Accueil</a>
          <a href="#" onclick="showPage('reservations')" data-i18n="nav_my_bookings">Mes R√©servations</a>
          <a href="#" onclick="showPage('about')" data-i18n="nav_about">√Ä propos</a>
        </div>
        <div class="footer-section">
          <h4 data-i18n="contact_title">Contact</h4>
          <p>Email: contact@en-bus.com</p>
          <p>T√©l: +242 06 123 4567</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p data-i18n="footer_copyright">&copy; 2025 En-Bus. Tous droits r√©serv√©s.</p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://npmcdn.com/flatpickr/dist/l10n/fr.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs2@0.0.2/qrcode.min.js"></script>

  <!-- ‚úÖ AJOUTER CETTE LIGNE AVANT translations.js ET app.js -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>



  <script src="translations.js"></script>
  <script src="app.js"></script>

  <script>
    // ... (votre script PWA est correct et reste inchang√©) ...
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("/sw.js")
          .then((registration) => {
            console.log("‚úÖ Service Worker enregistr√©:", registration.scope);
            registration.addEventListener("updatefound", () => {
              const newWorker = registration.installing;
              newWorker.addEventListener("statechange", () => {
                if (
                  newWorker.state === "installed" &&
                  navigator.serviceWorker.controller
                ) {


                  if (
                    confirm(
                      "Une nouvelle version est disponible ! Voulez-vous mettre √† jour ?"
                    )
                  ) {
                    newWorker.postMessage({ type: "SKIP_WAITING" });
                    window.location.reload();
                  }
                }
              });
            });
          })
          .catch((error) => {
            console.error("‚ùå Erreur Service Worker:", error);
          });
      });
      let refreshing;
      navigator.serviceWorker.addEventListener("controllerchange", () => {
        if (refreshing) return;
        refreshing = true;
        window.location.reload();
      });
    }
    let deferredPrompt;
    window.addEventListener("beforeinstallprompt", (e) => {
      e.preventDefault();
      deferredPrompt = e;
      showInstallButton();
    });
    function showInstallButton() {
      const installBtn = document.createElement("button");
      installBtn.className = "install-pwa-btn";
      installBtn.innerHTML = `<span style="font-size: 20px;">üì±</span><span>Installer l'application</span>`;
      installBtn.onclick = async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log(`Installation: ${outcome}`);
        if (outcome === "accepted") {
          installBtn.style.display = "none";
        }
        deferredPrompt = null;
      };
      document.body.appendChild(installBtn);
      setTimeout(() => {
        installBtn.classList.add("show");
      }, 2000);
    }
    if (
      window.matchMedia("(display-mode: standalone)").matches ||
      window.navigator.standalone
    ) {
      console.log("‚úÖ Application install√©e et lanc√©e en mode standalone");
      document.body.classList.add("pwa-installed");
    }
    window.addEventListener("online", () => {
      if (typeof Utils !== "undefined")
        Utils.showToast("Connexion r√©tablie", "success");
    });
    window.addEventListener("offline", () => {
      if (typeof Utils !== "undefined")
        Utils.showToast("Mode hors-ligne activ√©", "warning");
    });
  </script>





  <!-- ============================================
       üîÑ MODALE DE REPORT DE VOYAGE
       ============================================ -->
  <div id="report-modal" class="modal">
    <div class="modal-dialog" style="max-width: 700px;">
      <div class="modal-header">
        <h2 id="report-modal-title" class="modal-title">Reporter votre voyage</h2>
        <button class="modal-close" onclick="closeReportModal()">&times;</button>
      </div>
      <div id="report-modal-body" class="modal-body">
        <!-- Contenu g√©n√©r√© dynamiquement -->
      </div>
    </div>
  </div>

  <!-- DANS index.html, juste avant </body> -->

  <!-- ============================================
     ‚úÖ MODALE DE CONFIRMATION PERSONNALIS√âE
     ============================================ -->
  <div id="custom-confirm-modal" class="custom-modal-overlay" style="display: none;">
    <div class="custom-modal-card">
      <div class="custom-modal-header">
        <span id="custom-confirm-icon" class="custom-modal-icon"></span>
        <h3 id="custom-confirm-title"></h3>
      </div>
      <div class="custom-modal-body">
        <p id="custom-confirm-message"></p>
      </div>
      <div class="custom-modal-footer">
        <button id="custom-confirm-cancel-btn" class="btn btn-secondary">Annuler</button>
        <button id="custom-confirm-ok-btn" class="btn btn-danger">Confirmer</button>
      </div>
    </div>
  </div>





</body>

</html>